<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Decision Capsule · lokal · offline</title>
  <meta name="description" content="Hypothese → Entscheidung → Review. Objektiver mit Auto-Confidence. 100 % lokal, ohne Cloud." />
  <link rel="stylesheet" href="style.css">
</head>
<body class="simple">
  <header>
    <div class="wrap">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>Decision Capsule <span class="pill">lokal · offline</span></h1>
          <div class="sub">Hypothese → Entscheidung → Review. Objektiver mit Auto-Confidence.</div>
        </div>
        <div class="right flex">
          <button class="btn" id="btn-mode" type="button" title="Einfach/Pro umschalten">Modus: Einfach</button>
          <button class="btn" id="btn-export-json" type="button" title="Alle Kapseln & Profil exportieren">Export JSON</button>
          <label class="btn" for="import-json">Import JSON
            <input id="import-json" type="file" accept="application/json" style="display:none">
          </label>
        </div>
      </div>
    </div>
  </header>

  <main>
    <!-- Linke Spalte: Formular -->
    <section class="card" aria-label="Neue Capsule">
      <div class="head"><h2>Neue Capsule</h2><span class="tag">Alles bleibt lokal</span></div>
      <div class="body">
        <div class="hint">In 3 Schritten: <b>Titel</b> → <b>Entscheidung</b> → <b>Review-Datum</b>. Alles andere ist optional.</div>

        <div class="row">
          <div>
            <label for="title">Titel</label>
            <input id="title" type="text" placeholder="z. B. Neues Handy kaufen – ja oder nein?">
          </div>
          <div>
            <label for="reviewDate">Review-Datum</label>
            <input id="reviewDate" type="date">
          </div>
        </div>

        <label for="decision">Entscheidung (Kurzsatz)</label>
        <input id="decision" type="text" placeholder="Ich entscheide mich für … (kurz begründen).">

        <div class="row">
          <div class="advanced">
            <label for="options">Optionen (eine pro Zeile)</label>
            <textarea id="options" placeholder="Option A&#10;Option B&#10;Option C"></textarea>
          </div>
          <div>
            <label for="chosen">Gewählte Option</label>
            <input id="chosen" type="text" placeholder="Option B">

            <label for="confidenceRange" style="margin-top:10px">Erfolgswahrscheinlichkeit</label>
            <div class="range">
              <input id="confidenceRange" type="range" min="1" max="99" step="1" value="70" aria-label="Erfolgswahrscheinlichkeit">
              <output id="confidenceOut">70%</output>
              <button class="btn tiny" id="btn-apply-auto" type="button" title="Auto-Vorschlag übernehmen">Auto&nbsp;<span id="autoVal">–%</span></button>
            </div>
            <div class="muted mini" id="autoExplain">Auto-Vorschlag erscheint, sobald genügend Infos vorliegen.</div>
          </div>
        </div>

        <label for="success">Erfolgskriterium(e)</label>
        <input id="success" type="text" placeholder="Woran erkennst du den Erfolg? (z. B. Kosten < 300 € & Zufriedenheit ≥ 8/10)">

        <!-- Faktoren-Assistent (optional) -->
        <details class="factors" id="factors">
          <summary>Faktoren (optional, verbessern Auto-Confidence)</summary>
          <div class="row-3">
            <div>
              <label for="fac-reversible">Reversibel?</label>
              <select id="fac-reversible">
                <option value="1">Ja (rückgängig machbar)</option>
                <option value="0">Nein (irreversibel)</option>
              </select>
            </div>
            <div>
              <label for="fac-stake">Einsatz/Risiko</label>
              <select id="fac-stake">
                <option value="low">Niedrig</option>
                <option value="mid" selected>Mittel</option>
                <option value="high">Hoch</option>
              </select>
            </div>
            <div>
              <label for="fac-fam">Vertrautheit</label>
              <select id="fac-fam">
                <option value="0">Gering</option>
                <option value="1" selected>Mittel</option>
                <option value="2">Hoch</option>
              </select>
            </div>
          </div>
          <div class="row-3">
            <div>
              <label for="fac-evidence">Evidenz/Belege</label>
              <select id="fac-evidence">
                <option value="0">Keine</option>
                <option value="1" selected>Einige (Zahlen/Quellen)</option>
                <option value="2">Stark (Zahlen + Datum/Frist)</option>
              </select>
            </div>
            <div>
              <label for="fac-buffer">Zeitpuffer</label>
              <select id="fac-buffer">
                <option value="0">Knapp</option>
                <option value="1" selected>Mittel</option>
                <option value="2">Ausreichend</option>
              </select>
            </div>
            <div>
              <label for="templateSel">Vorlage</label>
              <select id="templateSel"></select>
              <div class="mini muted" id="catBadge">Kategorie: –</div>
            </div>
          </div>
        </details>

        <div class="row">
          <div class="advanced">
            <label for="reasons">Hauptgründe (eine pro Zeile)</label>
            <textarea id="reasons" placeholder="Grund 1&#10;Grund 2&#10;Grund 3"></textarea>
          </div>
          <div class="advanced">
            <label for="assumptions">Annahmen/Risiken (eine pro Zeile)</label>
            <textarea id="assumptions" placeholder="Annahme 1&#10;Risiko 1"></textarea>
          </div>
        </div>

        <div class="row">
          <div class="advanced">
            <label for="notes">Notizen (optional)</label>
            <textarea id="notes" placeholder="Kontext, Nebenbedingungen …"></textarea>
          </div>
          <div>
            <div class="hr"></div>
            <div class="flex">
              <button class="btn pri" id="btn-save" type="button">Capsule speichern</button>
              <button class="btn" id="btn-ics" type="button">Review-Termin (.ics)</button>
              <button class="btn warn" id="btn-clear" type="button">Formular leeren</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Rechte Spalte: Dashboard -->
    <section class="card" aria-label="Dashboard & Kapseln">
      <div class="head"><h2>Dashboard</h2><span class="tag" id="db-last-sync">Stand: –</span></div>
      <div class="body">
        <div class="stats">
          <div class="stat"><div class="muted">Offene Kapseln</div><b id="stat-open">0</b></div>
          <div class="stat"><div class="muted">Fällig ≤7 Tage</div><b id="stat-soon">0</b></div>
          <div class="stat"><div class="muted">Kalibrierung (Brier↓)</div><b id="stat-brier">–</b></div>
        </div>
        <div class="hr"></div>
        <h3 style="margin:0 0 8px 0">Fällig & demnächst</h3>
        <div id="list-due" class="list" aria-live="polite"></div>
        <div class="hr"></div>
        <h3 style="margin:0 0 8px 0">Alle Kapseln</h3>
        <div id="list-all" class="list" aria-live="polite"></div>
      </div>
    </section>

    <!-- Review -->
    <section class="card" aria-label="Review" style="grid-column: 1 / -1;">
      <div class="head"><h2>Review</h2><span class="tag">Ergebnis festhalten → Lernen</span></div>
      <div class="body">
        <div class="row">
          <div>
            <label for="rev-id">Capsule auswählen</label>
            <select id="rev-id"></select>
          </div>
          <div>
            <label for="rev-result">Ergebnis</label>
            <select id="rev-result">
              <option value="">– bitte wählen –</option>
              <option value="success">Erfolg (1)</option>
              <option value="partial">Teil-Erfolg (0.5)</option>
              <option value="fail">Fehlschlag (0)</option>
            </select>
          </div>
        </div>
        <label for="rev-notes">Review-Notizen</label>
        <textarea id="rev-notes" placeholder="Lernpunkte, Überraschungen, Änderungen für nächste Entscheidungen …"></textarea>
        <div class="flex">
          <button class="btn ok" id="btn-save-review" type="button">Review speichern</button>
          <button class="btn" id="btn-export-csv" type="button">CSV Export</button>
        </div>
      </div>
    </section>
  </main>

  <div class="footer wrap">
    <p>100 % lokal. Kein Login, keine Cloud. Exportiere regelmäßig <span class="kbd">JSON</span>; Import stellt Kapseln <em>und</em> Kalibrierungsprofil wieder her.</p>
  </div>

  <script src="app.js" defer></script>
</body>
</html>
